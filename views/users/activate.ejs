<%
_locals.title = "Activate your account";
_locals.noNav = true;
var email = locals.email;
%>
<link rel="stylesheet" href="/css/dynamic-password-validation.css"/>

<div class="row justify-content-center">
	<div class="col-md-6">

		<div class="rounded border p-5 my-5 bg-white">
			<h1 class="mb-2">Welcome</h1>
			<div class="mb-3">
				Set a secure password for signing in to Pluribus
			</div>

			<form method="post" id="activateForm" novalidate>
				<%/* Include email as a hidden text input so that password manager knows which login email to link to. */%>
				<input type="text" name="email" value="<%= email %>" style="display:none;" />

				<div class="form-floating mb-3">
					<input class="form-control" type="password" name="password" id="password" placeholder="secret" value="<%= postedValues.password %>" autocomplete="new-password" required/>
					<label class="form-label" for="password">Choose a password</label>
					<div class="invalid-feedback" id="passwordDynamicFeedback">
						Please enter a stronger password
					</div>
					<%- validationMessage('password') %>

					<div class="validation-feedback small" id="feedbackLowercase">One lowercase</div>
					<div class="validation-feedback small" id="feedbackUppercase">One uppercase</div>
					<div class="validation-feedback small" id="feedback8Chars">8 characters min.</div>
				</div>

				<div class="mb-3">
					<div class="form-check">
						<input class="form-check-input" type="checkbox" value="yes" id="accept" name="accept" <%- postedValues.agree ? 'checked' : '' %> required>
						<label class="form-check-label" for="accept">I accept the <a href="/terms" target="_blank">terms of service</a></label>
						<div class="invalid-feedback">
							Please accept our terms of service
						</div>
					</div>
					<%- validationMessage('agree') %>
				</div>

				<div>
					<button class="btn btn-primary w-100 py-3">Activate account</button>
				</div>
			</form>
		</div>
	</div>
</div>
<script src="/js/forms.js"></script>
<script>
	var activateForm = document.getElementById('activateForm');
	forms.addDynamicPasswordValidation(activateForm);
	forms.addPasswordVisibilityToggle(password);

</script>